<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√πa H√® Xanh UIT 2025 - unipage</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/Page/style.css">
    
</head>
<header class="header">
    <img src="/Public/assets/logo.png" alt="Logo M√πa H√® Xanh" class="logo">
    <h2> M√πa h√® xanh UIT 2025</h2>
    <button id ="log-out" class ="log-out-btn">ƒêƒÉng xu·∫•t</button>
</header>

<main>
    <section class="hero">
        <div class="hero-content">
            <h1>Ph·ªß Xanh M√πa H√®<br>C√πng M√πa H√® Xanh</h1>
            <p class="hero-text">M·ªôt m√πa h√® n·ªØa l·∫°i ƒë·∫øn, n·ªïi b·∫≠t gi·ªØa b·ª©c tranh m√πa h√® l√† h√¨nh ·∫£nh nh·ªØng sinh vi√™n t√¨nh nguy·ªán mang s·ª©c tr·∫ª, nhi·ªát huy·∫øt, hƒÉng h√°i tham gia c√°c ho·∫°t ƒë·ªông √Ω nghƒ©a, g√≥p ph·∫ßn lan t·ªèa tinh th·∫ßn v√¨ c·ªông ƒë·ªìng. M√πa H√® Xanh l√† n∆°i nh·ªØng chi·∫øn sƒ© √°o xanh c√πng nhau c·ªëng hi·∫øn tri th·ª©c tr·∫ª, g√≥p ph·∫ßn d·ª±ng x√¢y qu√™ h∆∞∆°ng, ƒë·∫•t n∆∞·ªõc t∆∞∆°i ƒë·∫πp, v·ªØng m·∫°nh.</p>
            <p class="hero-text">ƒê∆°n v·ªã ƒë·ªìng h√†nh</p>
            
            <div class="partner-icons">
                <img src="/Public/assets/partners-logo/partner-1.png" alt="Partner 1">
                <img src="/Public/assets/partners-logo/partner-2.png" alt="Partner 2">
                <img src="/Public/assets/partners-logo/partner-3.png" alt="Partner 3">
            </div>
        </div>
        <div class="hero-image">
            <img src="/Public/assets/image.png" alt="Green Summer Activities">
        </div>
    </section>
</main>
</header>
<style>
    .create-project-btn {
        background-color: #4CAF50; /* M√†u xanh l√° */
        color: white; /* M√†u ch·ªØ */
        border: none; /* Kh√¥ng c√≥ vi·ªÅn */
        padding: 10px 20px; /* Kho·∫£ng c√°ch b√™n trong */
        text-align: center; /* CƒÉn gi·ªØa ch·ªØ */
        text-decoration: none; /* Kh√¥ng c√≥ g·∫°ch ch√¢n */
        display: inline-block; /* Hi·ªÉn th·ªã nh∆∞ m·ªôt kh·ªëi inline */
        font-size: 16px; /* K√≠ch th∆∞·ªõc ch·ªØ */
        margin: 4px 2px; /* Kho·∫£ng c√°ch b√™n ngo√†i */
        cursor: pointer; /* Con tr·ªè chu·ªôt thay ƒë·ªïi khi hover */
        border-radius: 25px; /* Bo tr√≤n g√≥c nhi·ªÅu h∆°n */
        transition: background-color 0.3s ease; /* Hi·ªáu ·ª©ng chuy·ªÉn m√†u */
    }
    
    .create-project-btn:hover {
        background-color: #45a049; /* M√†u xanh ƒë·∫≠m h∆°n khi hover */
    }
    .log-out-btn {
    background-color: #d62a2a; /* M√†u xanh l√° */
    color: white; /* M√†u ch·ªØ */
    border: none; /* Kh√¥ng c√≥ vi·ªÅn */
    padding: 10px 20px; /* Kho·∫£ng c√°ch b√™n trong */
    text-align: center; /* CƒÉn gi·ªØa ch·ªØ */
    text-decoration: none; /* Kh√¥ng c√≥ g·∫°ch ch√¢n */
    display: inline-block; /* Hi·ªÉn th·ªã nh∆∞ m·ªôt kh·ªëi inline */
    font-size: 16px; /* K√≠ch th∆∞·ªõc ch·ªØ */
    margin: 4px 2px; /* Kho·∫£ng c√°ch b√™n ngo√†i */
    cursor: pointer; /* Con tr·ªè chu·ªôt thay ƒë·ªïi khi hover */
    border-radius: 25px; /* Bo tr√≤n g√≥c nhi·ªÅu h∆°n */
    transition: background-color 0.3s ease; /* Hi·ªáu ·ª©ng chuy·ªÉn m√†u */
}
    .dialog {
                display: none; /* ·∫®n dialog ban ƒë·∫ßu */
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: white;
                border-radius: 16px;
                box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                padding: 20px;
                width: 90%;
                max-width: 600px;
            }
            .overlay {
                display: none; /* ·∫®n overlay ban ƒë·∫ßu */
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 900;
            }
            h2 {
                text-align: center;
                margin-bottom: 0px;
                font-weight: bold;
            }
            .btn-cancel, .btn-submit {
                width: 48%;
                transition: background-color 0.3s ease-in-out;
            }
            .btn-cancel {
                background-color: #ff4d4d;
                border: none;
                color: white;
            }
            .btn-submit {
                background-color: #28a745;
                border: none;
                color: white;
            }
            .btn-cancel:hover {
                background-color: #ff1a1a;
            }
            .btn-submit:hover {
                background-color: #218838;
            }
            .error-message {
                color: red;
                font-size: 0.9em;
                display: none;
                margin-top: 5px;
            }
    
    </style>
    <!-- CSS t√πy ch·ªçn ƒë·ªÉ hi·ªÉn th·ªã dialog modal -->
    <style>
        .modal {
          position: fixed;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          justify-content: center;
          align-items: center;
        }
        .modal-content {
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 400px;
          text-align: center;
        }
        .close-button {
          cursor: pointer;
          color: red;
          font-size: 20px;
          position: absolute;
          top: 10px;
          right: 10px;
        }
      </style>
      <style>
      /* Styles cho modal */
      .modal {
          display: none; /* ·∫®n modal theo m·∫∑c ƒë·ªãnh */
          position: fixed; /* ƒê·∫∑t v·ªã tr√≠ c·ªë ƒë·ªãnh */
          z-index: 1000; /* ƒê·∫∑t z-index cao ƒë·ªÉ ƒë·∫£m b·∫£o modal n·∫±m tr√™n c√°c ph·∫ßn kh√°c */
          left: 0;
          top: 0;
          width: 100%; /* Chi·∫øm to√†n b·ªô chi·ªÅu r·ªông */
          height: 100%; /* Chi·∫øm to√†n b·ªô chi·ªÅu cao */
          overflow: auto; /* Th√™m cu·ªôn n·∫øu c·∫ßn */
          background-color: rgba(0, 0, 0, 0.5); /* N·ªÅn m·ªù */
      }
      
      /* Styles cho n·ªôi dung modal */
      .modal-content {
          background-color: #fefefe; /* N·ªÅn tr·∫Øng cho n·ªôi dung modal */
          margin: 15% auto; /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
          padding: 20px; /* Th√™m kho·∫£ng c√°ch b√™n trong */
          border: 1px solid #888; /* ƒê∆∞·ªùng vi·ªÅn */
          width: 100%; /* Chi·ªÅu r·ªông c·ªßa modal */
          max-width: 800px; /* Chi·ªÅu r·ªông t·ªëi ƒëa c·ªßa modal */
          border-radius: 8px; /* Bo tr√≤n g√≥c */
      }
      
      /* Styles cho n√∫t ƒë√≥ng */
      .close-button {
          color: #aaa; /* M√†u x√°m cho n√∫t ƒë√≥ng */
          float: right; /* ƒê∆∞a n√∫t ƒë√≥ng sang b√™n ph·∫£i */
          font-size: 28px; /* K√≠ch th∆∞·ªõc ch·ªØ cho n√∫t ƒë√≥ng */
          font-weight: bold; /* Ch·ªØ ƒë·∫≠m cho n√∫t ƒë√≥ng */
      }
      
      /* Styles cho n√∫t ƒë√≥ng khi hover */
      .close-button:hover,
      .close-button:focus {
          color: black; /* ƒê·ªïi m√†u khi hover */
          text-decoration: none; /* B·ªè g·∫°ch ch√¢n */
          cursor: pointer; /* Hi·ªÉn th·ªã con tr·ªè khi hover */
      }
      
      /* Styles cho ti√™u ƒë·ªÅ */
      h3 {
          margin: 0; /* B·ªè margin cho ti√™u ƒë·ªÅ */
      }
      
      /* Styles cho th√¥ng tin trong modal */
      p {
          font-size: 16px; /* K√≠ch th∆∞·ªõc ch·ªØ cho th√¥ng tin */
          margin: 8px 0; /* Kho·∫£ng c√°ch gi·ªØa c√°c ƒëo·∫°n */
      }
    </style>
<body>
    <header id="header-placeholder"></header>

        <section class="campaigns">
            <div class="campaigns-header">
                <div class="campaigns-title">
                    <span class="category-label">Ch∆∞a ƒë∆∞·ª£c duy·ªát</span>
                    <h2>C√°c Chi·∫øn D·ªãch</h2>
                </div>
                
            </div>
            <div id="campaignGridWaiting" class="campaign-grid"></div>

            <!-- Dialog modal s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông cho t·ª´ng chi·∫øn d·ªãch -->
            <div id="modalContainerWaiting"></div>
            
        </section>
        <br><br><br><br>
        <section class="campaigns">
            <div class="campaigns-header">
                <div class="campaigns-title">
                    <span class="category-label ">ƒê√£ ƒë∆∞·ª£c duy·ªát</span>
                    <h2>C√°c Chi·∫øn D·ªãch </h2>
                </div>
            </div>
            
                <div id="campaignGrid" class="campaign-grid"></div>

            <!-- Dialog modal s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông cho t·ª´ng chi·∫øn d·ªãch -->
            <div id="modalContainer"></div>
        </section>
        <footer id="footer-placeholder"></footer>
    </main>
    <script>
        fetch('/Page/Component/Footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-placeholder').innerHTML = data;
            });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+FniFNJ+zIFpbhrvY4hZfME6fI6q" crossorigin="anonymous"></script>
    <script>
        // H√†m l·∫•y d·ªØ li·ªáu t·ª´ API v√† hi·ªÉn th·ªã c√°c campaign card
        async function loadCampaigns() {
    try {
        const response = await fetch('https://localhost:7009/api/Campaign/CampaignOnGoing');  // G·ªçi API
        const campaigns = await response.json();  // Chuy·ªÉn d·ªØ li·ªáu JSON th√†nh m·∫£ng object
        const campaignGrid = document.getElementById("campaignGrid");
        const modalContainer = document.getElementById("modalContainer");

        campaignGrid.innerHTML = "";  // X√≥a n·ªôi dung c≈© n·∫øu c√≥
        modalContainer.innerHTML = "";  // X√≥a n·ªôi dung modal c≈© n·∫øu c√≥

        // Duy·ªát qua t·ª´ng chi·∫øn d·ªãch v√† t·∫°o card
        campaigns.forEach(campaign => {
            const card = document.createElement("div");
            card.className = "campaign-card";
            card.innerHTML = `
                <img src="/Public/Logo/campaign.png" alt="${campaign.name}">
                <div class="campaign-info">
                    <h3>${campaign.name}</h3>
                    <div class="date-container">
                        <span class="calendar-icon">üìÖ</span>
                        <span class="campaign-date">${campaign.time}</span>
                    </div>
                    <a href="#" class="register-button" onclick="openModal('${campaign.id}')">Xem Chi Ti·∫øt</a>
                </div>
            `;
            campaignGrid.appendChild(card);

            // T·∫°o modal cho t·ª´ng chi·∫øn d·ªãch
            const modal = document.createElement("div");
            modal.id = `campaignDetailModal-${campaign.id}`;
            modal.style.display = "none";
            modal.className = "modal";
            modal.innerHTML = `
                <div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="campaignName-${campaign.id}">${campaign.name}</h5>
        <button type="button" class="close" onclick="closeModal('${campaign.id}')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <p id="campaignUniversity-${campaign.id}"></p>
        <p id="campaignDescription-${campaign.id}"></p>
        <p id="campaignQuantity-${campaign.id}"></p>
        <p id="campaignTime-${campaign.id}"></p>
        <p id="campaignCreatedAt-${campaign.id}"></p>
        <p id="campaignStatus-${campaign.id}"></p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeModal('${campaign.id}')">ƒê√≥ng</button>
    </div>
</div>

            `;
            modalContainer.appendChild(modal);
        });
    } catch (error) {
        console.error("C√≥ l·ªói x·∫£y ra khi l·∫•y d·ªØ li·ªáu t·ª´ API:", error);
    }
}

// H√†m m·ªü modal v√† hi·ªÉn th·ªã chi ti·∫øt chi·∫øn d·ªãch
function openModal(campaignId) {
    fetch('https://localhost:7009/api/Campaign')
        .then(response => response.json())
        .then(campaigns => {
            const campaign = campaigns.find(c => c.id === campaignId);
            if (campaign) {
                document.getElementById(`campaignName-${campaignId}`).innerText = `T√™n ƒë·ªôi h√¨nh: ${campaign.name}`;
                document.getElementById(`campaignUniversity-${campaignId}`).innerText = `Tr∆∞·ªùng ƒê·∫°i h·ªçc: ${campaign.university}`;
                document.getElementById(`campaignDescription-${campaignId}`).innerText = `M√¥ t·∫£: ${campaign.description}`;
                document.getElementById(`campaignQuantity-${campaignId}`).innerText = `S·ªë l∆∞·ª£ng chi·∫øn sƒ©: ${campaign.quantity}`;
                document.getElementById(`campaignTime-${campaignId}`).innerText = `Th·ªùi gian: ${campaign.time}`;  // Hi·ªÉn th·ªã time d·∫°ng string
                document.getElementById(`campaignCreatedAt-${campaignId}`).innerText = `Chi·∫øn d·ªãch ƒë∆∞·ª£c t·∫°o l√∫c: ${new Date(campaign.createdAt).toLocaleString()}`;
                document.getElementById(`campaignStatus-${campaignId}`).innerText = `Tr·∫°ng th√°i: ${campaign.status}`;

                document.getElementById(`campaignDetailModal-${campaignId}`).style.display = "block";
            }
        })
        .catch(error => console.error('Error fetching campaign details:', error));
}

// H√†m ƒë√≥ng modal
function closeModal(campaignId) {
    document.getElementById(`campaignDetailModal-${campaignId}`).style.display = "none";
}

// G·ªçi h√†m loadCampaigns khi trang ƒë∆∞·ª£c t·∫£i
window.onload = loadCampaigns;

        document.getElementById('campaignForm').addEventListener('submit', async function(event) {
    event.preventDefault(); // NgƒÉn kh√¥ng cho form g·ª≠i ƒëi theo c√°ch m·∫∑c ƒë·ªãnh

    // L·∫•y d·ªØ li·ªáu t·ª´ c√°c tr∆∞·ªùng trong form
    const campaignData = {
        name: document.getElementById('campaignNamee').value,
        university: document.getElementById('University').value,
        timeStart: document.getElementById('startDate').value,
        timeEnd: document.getElementById('endDate').value,
        quantity: document.getElementById('participants').value,
        description: document.getElementById('description').value,
        location: document.getElementById('location').value
    };

    try {
        // G·ª≠i y√™u c·∫ßu POST ƒë·∫øn API
        const response = await fetch('https://localhost:7009/api/Campaign', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(campaignData)
        });

        if (response.ok) {
            // X·ª≠ l√Ω khi th√†nh c√¥ng
            alert('Chi·∫øn d·ªãch ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng!');
            document.getElementById('cancelBtn').click(); // ƒê√≥ng dialog sau khi t·∫°o th√†nh c√¥ng
        } else {
            // X·ª≠ l√Ω khi c√≥ l·ªói t·ª´ API
            const errorMessage = await response.json();
            alert(`C√≥ l·ªói x·∫£y ra: ${errorMessage.message || 'Kh√¥ng th·ªÉ t·∫°o chi·∫øn d·ªãch'}`);
        }
    } catch (error) {
        // X·ª≠ l√Ω l·ªói m·∫°ng ho·∫∑c l·ªói h·ªá th·ªëng
        alert(`C√≥ l·ªói x·∫£y ra: ${error.message}`);
    }
});

      </script>
      <script>
        // H√†m l·∫•y d·ªØ li·ªáu t·ª´ API v√† hi·ªÉn th·ªã c√°c campaign card
        async function loadCampaignsWaiting() {
    try {
        const response = await fetch('https://localhost:7009/api/Campaign/CampaignWaiting');  // G·ªçi API
        const campaigns = await response.json();  // Chuy·ªÉn d·ªØ li·ªáu JSON th√†nh m·∫£ng object
        const campaignGrid = document.getElementById("campaignGridWaiting");
        const modalContainer = document.getElementById("modalContainerWaiting");

        campaignGrid.innerHTML = "";  // X√≥a n·ªôi dung c≈© n·∫øu c√≥
        modalContainer.innerHTML = "";  // X√≥a n·ªôi dung modal c≈© n·∫øu c√≥

        // Duy·ªát qua t·ª´ng chi·∫øn d·ªãch v√† t·∫°o card
        campaigns.forEach(campaign => {
            const card = document.createElement("div");
            card.className = "campaign-card";
            card.innerHTML = `
                <img src="/Public/Logo/campaign.png" alt="${campaign.name}">
                <div class="campaign-info">
                    <h3>${campaign.name}</h3>
                    <div class="date-container">
                        <span class="calendar-icon">üìÖ</span>
                        <span class="campaign-date">${campaign.time}</span>
                    </div>
                    <a href="#" class="register-button" onclick="openModal('${campaign.id}')">Duy·ªát</a>
                </div>
            `;
            campaignGrid.appendChild(card);

            // T·∫°o modal cho t·ª´ng chi·∫øn d·ªãch
            const modal = document.createElement("div");
            modal.id = `campaignDetailModal-${campaign.id}`;
            modal.style.display = "none";
            modal.className = "modal";
            modal.innerHTML = `
                <div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="campaignName-${campaign.id}">${campaign.name}</h5>
        <button type="button" class="close" onclick="closeModal('${campaign.id}')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <p id="campaignUniversity-${campaign.id}"></p>
        <p id="campaignDescription-${campaign.id}"></p>
        <p id="campaignQuantity-${campaign.id}"></p>
        <p id="campaignTime-${campaign.id}"></p>
        <p id="campaignCreatedAt-${campaign.id}"></p>
        <p id="campaignStatus-${campaign.id}"></p>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" onclick="approveCampaign('${campaign.id}')">Duy·ªát</button>
        <button type="button" class="btn btn-secondary" onclick="closeModal('${campaign.id}')">ƒê√≥ng</button>
    </div>
</div>

            `;
            modalContainer.appendChild(modal);
        });
    } catch (error) {
        console.error("C√≥ l·ªói x·∫£y ra khi l·∫•y d·ªØ li·ªáu t·ª´ API:", error);
    }
}

async function approveCampaign(campaignId) {
    try {
        const response = await fetch(`https://localhost:7009/api/Campaign/ApproveCampaign?id=${campaignId}`, {
            method: 'PUT' // Assuming the API accepts a POST request
        });
        const result = await response.json();

        // Ki·ªÉm tra k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ API
        if (result.success) {
            alert(result.data); // Hi·ªán th√¥ng b√°o th√†nh c√¥ng
            closeModal(campaignId); // ƒê√≥ng modal
            location.reload(); // Reload l·∫°i trang
        } else {
            alert("C√≥ l·ªói x·∫£y ra: " + result.data); // Hi·ªán th√¥ng b√°o l·ªói
        }
    } catch (error) {
        console.error("C√≥ l·ªói x·∫£y ra khi duy·ªát chi·∫øn d·ªãch:", error);
        alert("C√≥ l·ªói x·∫£y ra khi duy·ªát chi·∫øn d·ªãch. Vui l√≤ng th·ª≠ l·∫°i.");
    }
}


// H√†m ƒë√≥ng modal
function closeModal(campaignId) {
    document.getElementById(`campaignDetailModal-${campaignId}`).style.display = "none";
}

// H√†m k·∫øt h·ª£p g·ªçi c·∫£ hai API
async function loadCampaignsTwo() {
    await Promise.all([loadCampaigns(), loadCampaignsWaiting()]); // Ch·∫°y c·∫£ hai API
}
// G·ªçi h√†m loadCampaigns khi trang ƒë∆∞·ª£c t·∫£i
window.onload = loadCampaignsTwo;
</script>
<script>
    document.getElementById("log-out").addEventListener("click", function() {
        window.location.replace("login.html"); });
</script>
</body>
</html>